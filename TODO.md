Not sure charges are being defined as global variables, check if they are, otherwise fix it.
